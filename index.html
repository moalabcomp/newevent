<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2026 ëª¨ì•„ê²½ì œTV ì„¤ë§ì´ ì´ë²¤íŠ¸</title>
  <style>
    body { font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif; text-align: center; padding: 20px; background-color: #f7f9fc; margin: 0; }
    .container { max-width: 450px; margin: 0 auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-top: 15px;}
    
    /* [ì‹ ê·œ] ìƒë‹¨ ìƒíƒœì°½ ìŠ¤íƒ€ì¼ */
    #status-board {
      max-width: 480px; margin: 0 auto 10px auto; 
      padding: 15px; border-radius: 12px; color: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.5s;
    }
    .status-before { background-color: #333; } /* ì‹œì‘ ì „: ê²€ì • */
    .status-ing { background-color: #d32f2f; } /* ì§„í–‰ ì¤‘: ë¹¨ê°• */
    .status-end { background-color: #555; }    /* ì¢…ë£Œ: íšŒìƒ‰ */

    .timer-text { font-size: 14px; margin-bottom: 5px; opacity: 0.9; }
    .timer-number { font-size: 28px; font-weight: 900; letter-spacing: 1px; }
    
    /* ì‹¤ì‹œê°„ ì¬ê³  ë¦¬ìŠ¤íŠ¸ */
    .stock-grid {
      display: none; /* ì‹œì‘ ì „ì—” ì•ˆ ë³´ì„ */
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 15px;
    }
    .stock-item {
      background: rgba(255,255,255,0.2);
      padding: 8px;
      border-radius: 8px;
      text-align: left;
      font-size: 13px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .stock-count { font-weight: bold; font-size: 16px; color: #fff; }
    .sold-out { opacity: 0.5; text-decoration: line-through; }

    /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
    .screen { display: none; animation: fadeIn 0.4s; }
    .screen.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .notice-box { text-align: left; font-size: 14px; line-height: 1.6; background: #f9f9f9; padding: 15px; border-radius: 8px; height: 320px; overflow-y: auto; border: 1px solid #ddd; margin-bottom: 15px; }
    .notice-box h3 { margin-top: 0; color: #d32f2f; font-size: 16px; }
    .member-badge { display: inline-block; background-color: #d32f2f; color: white; font-weight: bold; padding: 5px 15px; border-radius: 20px; font-size: 15px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(211, 47, 47, 0.3); }
    .input-guide { font-size: 18px; font-weight: 900; color: #333; margin: 20px 0 10px 0; line-height: 1.4; }
    .input-guide span { color: #d32f2f; }
    .safe-note { font-size: 13px; color: #666; margin-top: 8px; margin-bottom: 20px; background-color: #f0f0f0; padding: 8px; border-radius: 6px; }
    input[type="text"], input[type="tel"] { width: 90%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; }
    .checkbox-label { display: block; margin: 15px 0; font-size: 15px; font-weight: bold; cursor: pointer; }
    button { background-color: #d32f2f; color: white; border: none; padding: 15px 20px; width: 100%; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 5px; transition: background 0.2s; }
    button:hover { background-color: #b71c1c; }
    button:disabled { background-color: #aaa; cursor: not-allowed; }
    .win-title { font-size: 24px; color: #d32f2f; margin-bottom: 20px; font-weight: bold; }
    .win-prize { font-size: 26px; font-weight: bold; color: #111; padding: 20px 0; line-height: 1.4; border-top: 2px dashed #eee; border-bottom: 2px dashed #eee; }
    .win-footer { font-size: 14px; color: #666; margin-top: 20px; }
    .error-msg { font-size: 18px; font-weight: bold; color: #333; margin-top: 30px; line-height: 1.5; }
  </style>
</head>
<body>

  <div id="status-board" class="status-before">
    <div id="status-text" class="timer-text">ì´ë²¤íŠ¸ ì˜¤í”ˆê¹Œì§€ ë‚¨ì€ ì‹œê°„</div>
    <div id="timer-display" class="timer-number">--:--:--</div>
    
    <div id="stock-area" class="stock-grid">
      <div style="grid-column: span 2; font-size:12px;">â³ ì‹¤ì‹œê°„ ì”ì—¬ ìˆ˜ëŸ‰ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>
  </div>

  <div class="container">
    <div id="screen-notice" class="screen active">
      <h2 style="color: #d32f2f; margin-top: 0; margin-bottom: 10px;">ğŸ§§ 2026 ëª¨ì•„ê²½ì œTV<br>ìƒˆí•´ ë§ì´ ê²½í’ˆ ì´ë²¤íŠ¸ ğŸ§§</h2>
      <div class="member-badge">MEMBERSHIP ONLY (ë©¤ë²„ì‹­ ì „ìš©)</div>
      <div class="notice-box">
        <h3>ğŸ“… ì´ë²¤íŠ¸ ê¸°ê°„</h3>
        â€¢ ë³¸ í–‰ì‚¬: 2026ë…„ 2ì›” 16ì¼(ì›”) ~ 2ì›” 18ì¼(ìˆ˜) (3ì¼ê°„)<br>
        â€¢ ì”ì—¬ë¶„ ì¶”ì²¨: 2ì›” 19ì¼(ëª©) [íŒ¨ìë¶€í™œì „ - 1ì¸ 2íšŒ ì°¸ì—¬ ê°€ëŠ¥!]<br><br>
        <h3>ğŸ ê²½í’ˆ êµ¬ì„± (ì´ 19ëª…!)</h3>
        ğŸ¥‡ 1ë“± (1ëª…): ëª…í’ˆ í•œìš° SET ğŸ¥©<br>
        ğŸ¥ˆ 2ë“± (3ëª…): í”„ë¦¬ë¯¸ì—„ ê³¼ì¼ SET ğŸ<br>
        ğŸ¥‰ 3ë“± (5ëª…): ì¹˜í‚¨ ê¸°í”„í‹°ì½˜ ğŸ—<br>
        ğŸ… 4ë“± (10ëª…): ì»¤í”¼ ê¸°í”„í‹°ì½˜ â˜•<br><br>
        <h3>ğŸ“ ì°¸ì—¬ ë°©ë²•</h3>
        1. ë©¤ë²„ì‹­ì— ë“±ë¡ëœ ë³¸ì¸ ì„±í•¨ê³¼ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.<br>
        2. ì œì¶œ í›„ ì¦‰ì‹œ ë‹¹ì²¨ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì„¸ìš”!<br>
        3. ë‹¹ì²¨ë˜ì‹  ë¶„ì€ ë‹¹ì²¨ í™”ë©´ì„ ìº¡ì³í•˜ì—¬ ì¹´ì¹´ì˜¤í†¡ë°©ì— ì¸ì¦í•´ì£¼ì‹œë©´ í™•ì¸ í›„ ê²½í’ˆì„ ë°œì†¡í•´ ë“œë¦½ë‹ˆë‹¤!<br><br>
        <h3>âš ï¸ ê¼­ í™•ì¸í•´ì£¼ì„¸ìš”!</h3>
        â€¢ ë³¸ ì´ë²¤íŠ¸ëŠ” ë¯¸ë¦¬ ë“±ë¡ëœ ë©¤ë²„ì‹­ ëª…ë‹¨ì— ìˆëŠ” ë¶„ë“¤ë§Œ ì°¸ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤. ğŸš«<br>
        â€¢ 16ì¼~18ì¼ì—ëŠ” í•˜ë£¨ì— ë”± 1ë²ˆë§Œ ì°¸ì—¬í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
        â€¢ 19ì¼ì—ëŠ” ë‚¨ì€ ê²½í’ˆ ì†Œì§„ì„ ìœ„í•´ 1ì¸ 2íšŒê¹Œì§€ ê¸°íšŒë¥¼ ë“œë¦½ë‹ˆë‹¤! ğŸ”¥<br>
        â€¢ ë²ˆí˜¸ê°€ í‹€ë¦¬ë©´ ë‹¹ì²¨ì—ì„œ ì œì™¸ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•´ì£¼ì„¸ìš”!
      </div>
      <label class="checkbox-label"><input type="checkbox" id="checkAgree"> í™•ì¸í–ˆìŠµë‹ˆë‹¤ (ì„ íƒ)</label>
      <button onclick="goToForm()">ë‹¤ìŒìœ¼ë¡œ ğŸ‘‰</button>
    </div>

    <div id="screen-form" class="screen">
      <h2 style="color: #d32f2f;">ì •ë³´ ì…ë ¥</h2>
      <div class="input-guide"><span>ëª¨ì•„ê²½ì œTV íšŒì› ê°€ì… ë²ˆí˜¸</span>ë¥¼<br>ì…ë ¥í•˜ì„¸ìš”</div>
      <input type="text" id="userName" placeholder="ì„±í•¨ ì…ë ¥">
      <input type="tel" id="userPhone" placeholder="ì „í™”ë²ˆí˜¸ (ì˜ˆ: 01012345678)">
      <div class="safe-note">*ì´ë²¤íŠ¸ ì°¸ì—¬ ì™¸ ë‹¤ë¥¸ ëª©ì ìœ¼ë¡œ í™œìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤âœ–ï¸</div>
      <button id="submitBtn" onclick="runLottery()">ì„ ë¬¼ ë½‘ê¸°! ğŸ²</button>
    </div>

    <div id="screen-result" class="screen"></div>
  </div>

  <script>
    // âš ï¸ êµ¬ê¸€ ë°°í¬ URLì„ ì—¬ê¸°ì— ë‹¤ì‹œ ë„£ì–´ì£¼ì„¸ìš”!
    var scriptURL = "https://script.google.com/macros/s/AKfycbx8SxGpT98SlG3P_La_9Jmz6kMN7fMmgY3L8GfFN64Gw0Twvx32MBzQ5mXzypvzy3s7/exec"; 

    // ë‚ ì§œ ì„¤ì •
    var startDate = new Date("2026-02-16T00:00:00+09:00").getTime();
    var endDate = new Date("2026-02-19T23:59:59+09:00").getTime();
    
    // 1ì´ˆë§ˆë‹¤ íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
    setInterval(updateStatus, 1000);
    updateStatus(); // ë¡œë”© ì¦‰ì‹œ ì‹¤í–‰

    function updateStatus() {
      var now = new Date().getTime();
      var board = document.getElementById('status-board');
      var textDiv = document.getElementById('status-text');
      var timerDiv = document.getElementById('timer-display');
      var stockArea = document.getElementById('stock-area');

      if (now < startDate) {
        // [ê¸°ê°„ ì „]
        board.className = 'status-before';
        textDiv.innerText = "ì´ë²¤íŠ¸ ì˜¤í”ˆê¹Œì§€ ë‚¨ì€ ì‹œê°„";
        timerDiv.innerText = formatTime(startDate - now);
        stockArea.style.display = 'none'; // ì¬ê³  ìˆ¨ê¹€

      } else if (now >= startDate && now <= endDate) {
        // [ê¸°ê°„ ì¤‘]
        board.className = 'status-ing';
        textDiv.innerText = "ğŸš¨ ì´ë²¤íŠ¸ ì¢…ë£Œê¹Œì§€ ë‚¨ì€ ì‹œê°„";
        timerDiv.innerText = formatTime(endDate - now);
        stockArea.style.display = 'grid'; // ì¬ê³  ë³´ì—¬ì¤Œ
        
        // ì¬ê³  ë°ì´í„°ê°€ ë¹„ì–´ìˆìœ¼ë©´ ìµœì´ˆ 1íšŒ ë¡œë”©
        if(stockArea.innerText.includes("ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘")) {
          fetchStock();
        }

      } else {
        // [ì¢…ë£Œ í›„]
        board.className = 'status-end';
        textDiv.innerText = "ê°ì‚¬í•©ë‹ˆë‹¤";
        timerDiv.innerText = "ì´ë²¤íŠ¸ê°€ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤";
        stockArea.style.display = 'none';
      }
    }

    // ì‹œê°„ í¬ë§· (00ì¼ 00:00:00)
    function formatTime(diff) {
      var days = Math.floor(diff / (1000 * 60 * 60 * 24));
      var hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      var minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      var seconds = Math.floor((diff % (1000 * 60)) / 1000);
      
      var h = hours < 10 ? "0"+hours : hours;
      var m = minutes < 10 ? "0"+minutes : minutes;
      var s = seconds < 10 ? "0"+seconds : seconds;
      
      if(days > 0) return days + "ì¼ " + h + ":" + m + ":" + s;
      return h + ":" + m + ":" + s;
    }

    // ì„œë²„ì—ì„œ ì¬ê³  ê°€ì ¸ì˜¤ê¸°
    function fetchStock() {
      fetch(scriptURL + "?action=getStock")
      .then(res => res.json())
      .then(res => {
        if(res.status === 'success') {
          var html = "";
          res.data.forEach(item => {
            var isSoldOut = item.count <= 0;
            var countText = isSoldOut ? "í’ˆì ˆ" : item.count + "ê°œ";
            var classAdd = isSoldOut ? " sold-out" : "";
            
            // ê²½í’ˆ ì´ë¦„ì—ì„œ '1ë“± :' ê°™ì€ê±° ë–¼ê³  ìƒí’ˆëª…ë§Œ ê°„ë‹¨íˆ ë³´ì—¬ì£¼ê¸° (ì„ íƒì‚¬í•­)
            var simpleName = item.name.split(':').pop().trim(); 

            html += `<div class="stock-item${classAdd}">
              <span>${simpleName}</span>
              <span class="stock-count">${countText}</span>
            </div>`;
          });
          document.getElementById('stock-area').innerHTML = html;
        }
      })
      .catch(e => console.log("ì¬ê³  ë¡œë”© ì‹¤íŒ¨"));
    }

    function goToForm() {
      document.getElementById('screen-notice').classList.remove('active');
      document.getElementById('screen-form').classList.add('active');
    }

    function runLottery() {
      var name = document.getElementById('userName').value;
      var phone = document.getElementById('userPhone').value;
      
      if(!name || !phone) {
        alert("ì„±í•¨ê³¼ ì „í™”ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      var btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.innerText = "ì¶”ì²¨ ì¤‘... ğŸ²";

      fetch(scriptURL + "?name=" + encodeURIComponent(name) + "&phone=" + encodeURIComponent(phone))
      .then(response => response.json())
      .then(res => {
          document.getElementById('screen-form').classList.remove('active');
          var resultScreen = document.getElementById('screen-result');
          
          if(res.status === 'win') {
            resultScreen.innerHTML = `
              <div class="win-title">ğŸŠë‹¹ì²¨ì„ ì¶•í•˜í•©ë‹ˆë‹¤!ğŸŠ</div>
              <div class="win-prize">${res.message}</div>
              <div class="win-footer">*ì„ ë¬¼ì€ 2/19ì¼ ëª¨ë°”ì¼ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤!</div>
            `;
          } else {
            var msg = (res.status === 'error') ? res.message : "ğŸ˜­ ì•„ì‰½ì§€ë§Œ ê½! ë‹¤ìŒ ê¸°íšŒì—..";
            resultScreen.innerHTML = `
              <div class="error-msg">${msg}</div>
              <button onclick="location.reload()" style="margin-top:40px; background:#555;">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            `;
          }
          resultScreen.classList.add('active');
      })
      .catch(error => {
          alert("í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
          btn.innerText = "ì„ ë¬¼ ë½‘ê¸°! ğŸ²";
          btn.disabled = false;
      });
    }
  </script>
</body>
</html>
